<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>make url comprehensible</title>
<link rel="stylesheet" href="jquery-ui/jquery-ui.css">
<script src="jquery-ui/external/jquery/jquery.js"></script>
<script src="jquery-ui/jquery-ui.js"></script>
<link rel="stylesheet" href="css/urlUtil.css">
<script src="js/urlUtil.js"></script>
<style>
#origin-url{
	position:absolute;
	top:0;
	left:0;
	width:100%;
	height:20%;
}
#parameters{
	position:relative;
	float:left;
	height:80%;
	width:50%;
}
#url-response{
	position:relative;
	float:right;
	height:height:80%;
	width:50%;
}

</style>
<script>
	//参数链接信息
	var data = {};
	$(document).ready(function(){
		$("#url").change(function(){
			var url,dataArray,paramStr,link,linkLen,containerDom,scriptStr;
			url = this.value;
			//去除链接前面多余信息
			url = url.substring(url.indexOf("http://"));
			//去除全部换行符
			url = url.replace(/[\n]/ig,'');	
			console.log("当前url为："+url);
			//获取域名链接
			linkLen = url.indexOf("?")
			link = url.substring(0,linkLen);
			console.log("链接为："+link);
			//参数字符串
			paramStr = url.substring(linkLen+1);
			dataArray = paramStr.split('&');
			
			//新建容器存储参数数据
			containerDom = document.createElement("div");
		
			//显示链接			
			scriptStr = "<table>";
			scriptStr += '<tr><td>domain：</td><td><input type="text"  style="width:300px" id="domain" value="'+link+'"></td></tr>';
			//遍历参数
			for(var i in dataArray){
				var nameLen = dataArray[i].indexOf("=");
				var name = dataArray[i].substring(0,nameLen);
				var value = dataArray[i].substring(nameLen+1);				
				scriptStr += '<tr><td>'+name+'：</td><td><input type="text" style="width:300px" id="'+name+'" value="'+value+'"></td></tr>';
				data[name]=value;
			}
			
			scriptStr += '</table>';
			$("#parameters").empty();
			$("#parameters").append(scriptStr);
			$("input").change(function(){
				var id = this.id;
				data[id] = this.value;
			});
		});
		
	});
	document.onkeydown = keydown;
	function keydown(e){
		if(e.keyCode == 13){
			convert();
		}
	}
	function convert(){
		var urlDom = document.getElementById("url");
		var url = urlDom.value;
		var resultDom = document.getElementById("result");
		resultDom.innerHTML = jsonFromUrl(url);
	}
	function jsonFromUrl(url){
		var start,jsonStr,dataArray,data,result="";
		start = url.indexOf('?');
		jsonStr= url.substring(start+1);
		dataArray = jsonStr.split('&');
		for(var i in dataArray){
			data = dataArray[i].split("=");
			result += data[0] + " = " + data[1] + "<br>";
		}	
		return result;
	}
</script>
</head>
<body>
<div id="origin-url">
	<textarea id="url" cols=100 rows=6></textarea>
</div>
<div id="parameters">
</div>
<div id="url-response"></div>





</body>
</html>